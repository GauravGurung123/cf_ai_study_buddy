name = "cf-ai-study-buddy"
main = "src/index.ts"
compatibility_date = "2024-10-01"
workers_dev = true

[observability]
enabled = true

# Workers AI binding
[ai]
binding = "AI"

# Durable Objects - Updated for free plan (SQLite-based)
[[durable_objects.bindings]]
name = "STUDY_STATE"
class_name = "StudyState"
script_name = "cf-ai-study-buddy"

# IMPORTANT: Use new_sqlite_classes for free plan compatibility
[[migrations]]
tag = "v1"
new_sqlite_classes = ["StudyState"]

# Workflows binding
[[workflows]]
binding = "STUDY_WORKFLOW"
name = "study-session-workflow"
class_name = "StudySessionWorkflow"

[[workflows]]
binding = "QUIZ_WORKFLOW"
name = "quiz-generation-workflow"
class_name = "QuizGenerationWorkflow"

# KV for caching
[[kv_namespaces]]
binding = "CACHE"
id = "a3382b847edb401db4842c3c4e362ea6"

# Environment variables
[vars]
ENVIRONMENT = "development"
MAX_SESSION_DURATION = "7200"
MAX_QUIZ_QUESTIONS = "20"

# Development environment
[env.development]
name = "cf-ai-study-buddy-dev"
vars = { ENVIRONMENT = "development" }

[[env.development.kv_namespaces]]
binding = "CACHE"
id = "a3382b847edb401db4842c3c4e362ea6"

# Production environment
[env.production]
name = "cf-ai-study-buddy"
vars = { ENVIRONMENT = "production" }

[[env.production.kv_namespaces]]
binding = "CACHE"
id = "a3382b847edb401db4842c3c4e362ea6"

# Build configuration
[build]
command = "npm run build"
